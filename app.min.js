function send(){var s=$("#q").val();if(""==s)return 0;$("#q").val(""),$($("#transcript").find(".msg")[$("#transcript").find(".msg").length-1]).removeClass("bottom"),$("#transcript").append('<div class="msg user">'+s+'<div class="whouser who">You</div></div><br class="clear"/>');var t="api.php?q="+encodeURI(s);$("#transcript").append('<div class="msg bot loader bottom"><span id="loadergif"></span><div class="whobot who">Us</div></div><br class="clear"/>'),hideSuggestions();var e=$("#transcript");e.scrollTop(e.get(0).scrollHeight),$.getJSON(t,function(t){var e="";if(e=0==t.length&&s.length>4?"WebChat was unable to handle your request":t.speech,void 0!==t.suggestions&&0!=t.suggestions.length){for(var n="",i=0;i<t.suggestions.length;i++)n=n+'<div class="suggestion" onclick="sendSuggestion(this)">'+t.suggestions[i]+"</div>";$("#suggestionsParent").html(n),showSuggestions()}$($("#transcript").find(".msg")[$("#transcript").find(".msg").length-1]).html(e+'<div class="whobot who">Us</div>'),$($("#transcript").find(".msg")[$("#transcript").find(".msg").length-1]).removeClass("loader"),$($("#transcript").find(".msg")[$("#transcript").find(".msg").length-1]).addClass("bottom");var o=$("#transcript");o.scrollTop(o.get(0).scrollHeight),$(".loader").hide()})}function detectEnter(s){13===s.keyCode&&(s.preventDefault(),send())}function hideSuggestions(){$("#suggestionOverlay").animate({bottom:"-50px",opacity:"0"},function(){$("#suggestionOverlay").css({display:"none"})})}function showSuggestions(){$("#suggestionOverlay").stop().css({display:"block"}).queue(function(){$("#suggestionOverlay").animate({bottom:"50px",opacity:"1"}),$(this).dequeue()})}function sendSuggestion(s){$("#q").val($(s).text()),send()}function closeWindow(){self.close()}function newSession(){window.location.reload(!1)}$(document).ready(function(){$("#transcript").append('<div class="msg bot first">Welcome to WebChat!<div class="whobot who">Us</div></div><br class="clear"/>')});